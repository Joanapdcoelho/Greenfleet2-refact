<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:validation="http://www.mulesoft.org/schema/mule/validation" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/validation http://www.mulesoft.org/schema/mule/validation/current/mule-validation.xsd">
	<http:request-config name="Papi-HTTP_Request_config" doc:name="HTTP Request config" doc:id="1e783020-2854-4434-8abf-4731023a33e8" basePath="/api">
		<http:request-connection host="localhost" port="8082" />
	</http:request-config>
	<sub-flow name="getAccount" doc:id="28b2a1a2-7d02-4693-bc6a-e0e9b7f71d9a" >
		<http:request method="GET" doc:name="Request" doc:id="c594891e-a827-44af-ad3a-a187ed8016f4" config-ref="HTTP_Request_configuration(Process)" path="/api/account" />
	</sub-flow>
	<sub-flow name="getAccount\(ID)" doc:id="cc367806-15a3-4d58-bed3-b3cbb2108ca0" >
		<logger level="INFO" doc:name="Logger" doc:id="7d1486fd-c6fa-4462-9861-1e138a5db806" />
		<http:request method="GET" doc:name="Request" doc:id="186eb0af-5ada-45dc-aa63-64e5a91e48b7" config-ref="HTTP_Request_configuration(Process)" path="/api/account/{ID}" responseTimeout="#[30000000]">
			<http:uri-params><![CDATA[#[output application/java
---
{
	ID : attributes.uriParams.ID
}]]]></http:uri-params>
		</http:request>
	</sub-flow>
	<sub-flow name="getAccount\(ID)\vehicles" doc:id="324a647f-035e-436b-9536-fc0b2873b3e3" >
		<logger level="INFO" doc:name="Logger" doc:id="589df721-ce3e-4aea-95e1-2679367fde2e" />
		<http:request method="GET" doc:name="Request" doc:id="fb3fd4d0-8aef-468c-8b70-a27f5f9855e7" config-ref="HTTP_Request_configuration(Process)" path="/api/account/{ID}/vehicles" responseTimeout="#[30000000000000000]">
			<http:uri-params><![CDATA[#[output application/java
---
{
	ID : attributes.uriParams.ID
}]]]></http:uri-params>
			<http:query-params><![CDATA[#[output application/java
---
{
	model : attributes.queryParams.model,
	brand : attributes.queryParams.brand,
	status : attributes.queryParams.status
}]]]></http:query-params>
		</http:request>
	</sub-flow>
	<sub-flow name="postAccount" doc:id="361727bb-0a09-4a32-b781-0ca29b1a74d6" >
		<logger level="INFO" doc:name="Logger" doc:id="ae071048-c686-45ec-8d78-e80e0dcdf77e" message="#[payload]" />
		<http:request method="POST" doc:name="Request" doc:id="f0bbbc5a-a0cd-4262-a21b-579199eb1f6b" config-ref="HTTP_Request_configuration(Process)" path="/api/account" outputMimeType="application/json" responseTimeout="#[3000000000000]">
			<http:headers><![CDATA[#[%dw 2.0
output application/java
---
{
    "Content-Type": "application/json; charset=UTF-8",
    "Accept": "application/json"
}]]]></http:headers>
		</http:request>
		<ee:transform doc:name="Transform Message" doc:id="49b009ec-8d75-4e62-b4ad-af02b626d506">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{
  message: "Contas adicionas com Sucesso"
} as Object {encoding: "UTF-8", mediaType: "application/json"}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
	<sub-flow name="postMaintenance" doc:id="2ffb20da-76a8-4805-8618-6d654439c012" >
		<logger level="INFO" doc:name="Logger" doc:id="07836276-f07e-48f3-b0da-e8b537a0dcf7" message="#[payload]" />
		<http:request method="POST" doc:name="Request" doc:id="4365de02-be5e-4c97-aebf-092b4d49af08" config-ref="HTTP_Request_configuration(Process)" path="/api/maintenance" outputMimeType="application/json" responseTimeout="#[3000000000]">
			<http:headers><![CDATA[#[%dw 2.0
output application/java
---
{
    "Content-Type": "application/json; charset=UTF-8",
    "Accept": "application/json"
}]]]></http:headers>
		</http:request>
		<ee:transform doc:name="Transform Message" doc:id="f9bf60ad-b753-41d5-b45a-85a6ffa65d62">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{
  message: "Pedido de manutenção adicionado"
} as Object {encoding: "UTF-8", mediaType: "application/json"}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
	<sub-flow name="Post-accounts2" doc:id="9c97f069-b3c9-4623-a55f-edb7e963f27f" >
		<http:request doc:name="RequestPapi" doc:id="db42f902-8aa2-4a44-b01d-f6c4722feb6a" config-ref="Papi-HTTP_Request_config" method="POST" path="/accounts2" />
	</sub-flow>
</mule>
